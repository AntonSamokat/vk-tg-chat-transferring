# Export module

Это модуль для выгрузки сообщений из беседы vk на диск. На этом этапе файлы, видео и фотографии не скачиваются.

## Базовое использование

1. Откройте браузер и перейдите на страницу беседы vk
2. Скопируйте URL страницы, например: `https://vk.com/im?sel=c142`
3. Выполните команду, подставив полученный адрес:
   ```bash
   $ ./main.py export --chat <URL>
   ```

## Выгрузка сообщений из vk

Чтобы выгрузить сообщения, необходимо указать id беседы:

1. указать ссылку на беседу, например, `https://vk.com/im?sel=c142`
2. или указать id беседы напрямую:
    * для личных сообщений ссылка выглядит как `vk.com/im?sel=187654321`, id беседы равен 187654321
    * для группового чата ссылка выглядит как `vk.com/im?sel=c142`, id беседы равен 2000000142 (нужно прибавить
      2'000'000'000)

Узнав id беседы, добавьте опцию `--chat <ID>`.

Из беседы выгружаются все сообщения. Если добавить опцию `-n <N>`, будут выгружены только последние N сообщений.

Чтобы выключить прогресс-бар, добавьте опцию `--no-progress-bar`.

Данные сохраняются в файл `vk_history.pickle`. Чтобы сохранить их в другое место, добавьте опцию `--export-file <file>`.

## Выгрузка сообщений из vk в "сыром" формате

Этот режим предназначен для отладки. Он выгружает данные с сервера vk, но не преобразует их во внутренний формат,
а оставляет "сырыми".

Режим активируется опцией `--raw-export`. Остальные опции аналогичны предыдущему разделу.

Данные сохраняются в файл `vk_raw_history.json`. Чтобы сохранить их в другое место, добавьте
опцию `--export-file <file>`.

## Выгрузка "сырых" сообщений из файла

Этот режим читает сохраненные "сырые" сообщения, описанные в прошлом разделе, и преобразует их во внутренний формат.
Соединение с серверами vk не производится.

Для активации этого режима, выполните:

```bash
$ ./main.py export --raw-import
```

Данные считываются из файла `vk_raw_history.json`. Чтобы изменить входной файл, укажите `--raw-import <file>`.

Данные сохраняются в файл `vk_history.pickle`. Чтобы сохранить их в другое место, добавьте опцию `--export-file <file>`.

Использование других опций в этом режиме недопустимо или не имеет эффекта.

## Список опций

```
--chat ID/LINK            Id чата или ссылка на него 
-n N                      Выгрузить только последние N сообщений 
--export-file PATH        Файл, в который будут сохранены сообщения
--no-progress-bar         Отключить прогресс-бар

--raw-export              Выгрузить сообщения в "сыром" формате               

--raw-input [PATH]        Загрузить "сырые" сообщения из указанного файла или, если не указано, файла по умолчанию 
```
 